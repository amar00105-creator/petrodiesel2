import{j as e,m as D,F as x,ah as F,h as T,a2 as E,o as L,$ as P,T as q}from"./ui-DtuMUTb1.js";import{r as s}from"./vendor-BdFMDtQB.js";import{b as V,m as B,h as R,c as i}from"./main-CLVC6oQV.js";function O({purchase:t,suppliers:b=[],drivers:o=[],tanks:$=[],fuelTypes:g=[]}){const[u,f]=s.useState(!1),[n,j]=s.useState((t==null?void 0:t.volume_ordered)||""),[d,v]=s.useState((t==null?void 0:t.price_per_liter)||""),[r,N]=s.useState((t==null?void 0:t.total_cost)||0),[h,w]=s.useState((t==null?void 0:t.driver_name)||""),[p,m]=s.useState((t==null?void 0:t.truck_number)||""),[y,_]=s.useState(()=>{const l=(t==null?void 0:t.purchase_date)||(t==null?void 0:t.created_at);return l?l.split(" ")[0]:""});s.useEffect(()=>{const l=parseFloat(n)||0,a=parseFloat(d)||0;N(l*a)},[n,d]);const S=l=>{const a=l.target.value;w(a);const c=o.find(C=>C.name===a);c&&m(c.truck_number||"")},k=async l=>{l.preventDefault(),f(!0),l.target.submit()};return e.jsxs(D.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},className:"p-6 max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-4 rounded-3xl shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-indigo-600 rounded-2xl shadow-lg shadow-indigo-200",children:e.jsx(x,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx(V,{className:"text-2xl font-bold text-navy-900 font-cairo",children:"تعديل فاتورة مشتريات"}),e.jsx(B,{className:"text-slate-500",children:"تحديث بيانات الشحنة والفاتورة"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 px-4 py-2 rounded-xl border border-slate-200",children:[e.jsx(F,{className:"w-5 h-5 text-slate-500"}),e.jsx("span",{className:"text-lg font-mono font-bold text-slate-700",children:t==null?void 0:t.invoice_number})]}),e.jsxs(R,{type:"submit",form:"editForm",loading:u,className:"flex-1 md:flex-none py-3 px-6 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-bold shadow-lg shadow-indigo-500/20 border-none",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),"حفظ التعديلات"]})]})]}),e.jsxs("form",{id:"editForm",action:`${window.BASE_URL}/purchases/update`,method:"POST",className:"space-y-6",onSubmit:k,children:[e.jsx("input",{type:"hidden",name:"id",value:t==null?void 0:t.id}),e.jsx("input",{type:"hidden",name:"total_cost",value:r}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i,{className:"rounded-3xl shadow-sm ring-1 ring-amber-100 bg-amber-50/30",children:[e.jsxs("label",{className:"flex items-center gap-2 font-bold text-slate-700 mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-amber-500"})," المورد"]}),e.jsxs("select",{name:"supplier_id",defaultValue:t==null?void 0:t.supplier_id,className:"w-full p-3.5 rounded-xl border border-amber-200 focus:ring-2 focus:ring-amber-500 outline-none bg-white font-bold text-slate-700",required:!0,children:[e.jsx("option",{value:"",children:"اختر المورد..."}),b.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-amber-100",children:[e.jsxs("label",{className:"flex items-center gap-2 font-bold text-slate-700 mb-2",children:[e.jsx(L,{className:"w-5 h-5 text-amber-500"})," تاريخ الفاتورة"]}),e.jsx("input",{type:"date",name:"purchase_date",value:y,onChange:l=>_(l.target.value),className:"w-full p-3.5 rounded-xl border border-amber-200 focus:ring-2 focus:ring-amber-500 outline-none bg-white font-bold text-slate-700",required:!0})]})]}),e.jsxs(i,{className:"rounded-3xl shadow-sm ring-1 ring-blue-100 bg-blue-50/30",children:[e.jsxs("label",{className:"flex items-center gap-2 font-bold text-slate-700 mb-4",children:[e.jsx(x,{className:"w-5 h-5 text-blue-500"})," نوع الوقود"]}),e.jsxs("select",{name:"fuel_type_id",defaultValue:t==null?void 0:t.fuel_type_id,className:"w-full p-3.5 rounded-xl border border-blue-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white font-bold text-slate-700",children:[e.jsx("option",{value:"",children:"اختر نوع الوقود..."}),g.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i,{className:"rounded-3xl shadow-sm ring-1 ring-emerald-100 bg-emerald-50/30",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"الكمية (لتر)"}),e.jsx("input",{type:"number",step:"0.01",name:"volume_ordered",value:n,onChange:l=>j(l.target.value),className:"w-full p-3 rounded-xl border border-emerald-200 focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"0.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"السعر / لتر"}),e.jsx("input",{type:"number",step:"0.01",name:"price_per_liter",value:d,onChange:l=>v(l.target.value),className:"w-full p-3 rounded-xl border border-emerald-200 focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"bg-emerald-600 p-4 rounded-2xl text-white flex justify-between items-center shadow-lg shadow-emerald-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs opacity-80",children:"الإجمالي النهائي"}),e.jsx("div",{className:"font-bold text-lg",children:"Total Cost"})]})]}),e.jsxs("div",{className:"text-3xl font-black font-mono tracking-tighter",children:[r.toLocaleString(void 0,{minimumFractionDigits:2})," ",e.jsx("span",{className:"text-base font-normal opacity-70",children:"IQD"})]})]})]}),e.jsxs(i,{className:"rounded-3xl shadow-sm ring-1 ring-indigo-100 bg-indigo-50/30",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("label",{className:"flex items-center gap-2 font-bold text-slate-700",children:[e.jsx(q,{className:"w-5 h-5 text-indigo-500"})," السائق والشاحنة"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"driver_name",list:"driverList",value:h,onChange:S,className:"w-full p-3 rounded-xl border border-indigo-200 focus:ring-2 focus:ring-indigo-500 outline-none bg-white",placeholder:"اسم السائق..."}),e.jsx("datalist",{id:"driverList",children:o.map(l=>e.jsx("option",{value:l.name},l.id))})]}),e.jsx("input",{type:"text",name:"truck_number",value:p,onChange:l=>m(l.target.value),className:"w-full p-3 rounded-xl border border-indigo-200 focus:ring-2 focus:ring-indigo-500 outline-none bg-white",placeholder:"رقم الشاحنة"})]})]})]})]})]})]})}export{O as default};
