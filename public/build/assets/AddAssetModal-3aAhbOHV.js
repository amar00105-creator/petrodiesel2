import{r as g,j as e,a as j,m as u,t as r}from"./main-BZye3MWh.js";import{V as w,L as v}from"./vault-rYfJ9mF1.js";import{X as N}from"./x-CpP_tiue.js";import{S as y}from"./save-C_qR2yBp.js";function A({isOpen:x,onClose:a,type:b}){const[n,h]=g.useState({name:"",balance:"0",account_number:"",bank_name:""}),t=b==="safe",o=i=>{const{name:c,value:s}=i.target;h(l=>({...l,[c]:s}))},p=async i=>{i.preventDefault();const c=t?"/PETRODIESEL2/public/finance/createSafe":"/PETRODIESEL2/public/finance/createBank";try{const s=new FormData;Object.keys(n).forEach(m=>s.append(m,n[m]));const l=await fetch(c,{method:"POST",body:s,headers:{"X-Requested-With":"XMLHttpRequest"}}),f=await l.text();let d;try{d=JSON.parse(f)}catch{if(l.redirected||l.status===200){r.success(t?"تم إضافة الخزينة بنجاح":"تم إضافة البنك بنجاح"),a(),setTimeout(()=>window.location.reload(),500);return}throw new Error("Invalid server response")}d.success?(r.success(t?"تم إضافة الخزينة بنجاح":"تم إضافة البنك بنجاح"),a(),setTimeout(()=>window.location.reload(),500)):r.error(d.message||"حدث خطأ ما")}catch(s){console.error(s),r.error("خطأ في الاتصال بالخادم")}};return e.jsx(j,{children:x&&e.jsxs(e.Fragment,{children:[e.jsx(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,className:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-50 transition-opacity"}),e.jsx(u.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:e.jsxs("div",{className:"bg-white pointer-events-auto rounded-2xl shadow-2xl w-full max-w-md overflow-hidden flex flex-col",children:[e.jsxs("div",{className:`p-6 border-b flex justify-between items-center ${t?"bg-blue-50":"bg-indigo-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${t?"bg-blue-100 text-blue-600":"bg-indigo-100 text-indigo-600"}`,children:t?e.jsx(w,{className:"w-6 h-6"}):e.jsx(v,{className:"w-6 h-6"})}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:t?"إضافة خزينة جديدة":"إضافة حساب بنكي"})})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-white/50 rounded-full transition-colors",children:e.jsx(N,{className:"w-5 h-5 text-slate-500"})})]}),e.jsx("div",{className:"p-6 space-y-4",children:e.jsxs("form",{id:"asset-form",onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:t?"اسم الخزينة":"اسم البنك / الحساب"}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:o,className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-500/20",placeholder:t?"مثال: الخزينة الرئيسية":"مثال: بنك الراجحي - فرع الرياض",required:!0})]}),!t&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"رقم الحساب / الآيبان"}),e.jsx("input",{type:"text",name:"account_number",value:n.account_number,onChange:o,className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-indigo-500/20",placeholder:"SA000000..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"الرصيد الافتتاحي"}),e.jsx("input",{type:"number",step:"0.01",name:"balance",value:n.balance,onChange:o,className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-500/20",required:!0})]})]})}),e.jsxs("div",{className:"p-5 border-t bg-slate-50 flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 px-4 py-2.5 bg-white border border-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-100 transition-colors",children:"إلغاء"}),e.jsxs("button",{type:"submit",form:"asset-form",className:`flex-1 px-4 py-2.5 text-white rounded-xl font-bold shadow-lg transition-all flex items-center justify-center gap-2 ${t?"bg-blue-600 hover:bg-blue-700 shadow-blue-500/30":"bg-indigo-600 hover:bg-indigo-700 shadow-indigo-500/30"}`,children:[e.jsx(y,{className:"w-5 h-5"})," حفظ"]})]})]})})]})})}export{A};
