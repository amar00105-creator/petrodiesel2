import{f as q,r as a,j as e,w as O,_ as D,X as M,k as _,S as A,t as m,R as F,m as z,D as U,d as B,b as H,x as K,P as $,c as E,B as G,C as V,g as X,q as J,T as Q}from"./main-Jb7canCu.js";import{B as C}from"./briefcase-Q1BY2sTV.js";import{P as I}from"./phone-B98HPIy7.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],Z=q("hard-hat",Y);function ee({isOpen:d,onClose:t,onSuccess:n}){const[c,l]=a.useState({name:"",phone:""}),[p,x]=a.useState(!1),f=j=>{const{name:i,value:o}=j.target;l(r=>({...r,[i]:o}))},h=async j=>{j.preventDefault(),x(!0);const i=new FormData;i.append("name",c.name),i.append("phone",c.phone);try{const r=await(await fetch("/PETRODIESEL2/public/workers/create_ajax",{method:"POST",body:i})).json();r.success?(m.success("تم إضافة العامل بنجاح"),n(),t(),l({name:"",phone:""})):m.error(r.message||"حدث خطأ أثناء الإضافة")}catch{m.error("فشل الاتصال بالخادم")}finally{x(!1)}};return e.jsx(O,{open:d,onClose:t,static:!0,className:"z-[100]",children:e.jsxs(D,{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl ring-1 ring-slate-900/5 p-0 overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 border-b border-slate-100 p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-navy-900"}),"إضافة عامل جديد"]}),e.jsx("p",{className:"text-slate-500 text-sm",children:"أدخل بيانات العامل الجديد"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-500",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"الاسم"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"name",value:c.name,onChange:f,placeholder:"اسم العامل",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"رقم الهاتف"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"phone",value:c.phone,onChange:f,placeholder:"05xxxxxxxx",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all"})]})]}),e.jsxs("div",{className:"flex justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 rounded-lg transition-colors ml-2",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:p,className:"px-6 py-2 text-sm font-bold text-white bg-navy-900 hover:bg-navy-800 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center gap-2",children:p?"جاري الحفظ...":e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4"}),"حفظ"]})})]})]})]})})}function se({isOpen:d,onClose:t,worker:n,onSuccess:c}){const[l,p]=a.useState({id:"",name:"",phone:""}),[x,f]=a.useState(!1);a.useEffect(()=>{n&&p({id:n.id||"",name:n.name||"",phone:n.phone||""})},[n]);const h=i=>{const{name:o,value:r}=i.target;p(u=>({...u,[o]:r}))},j=async i=>{i.preventDefault(),f(!0);const o=new FormData;o.append("id",l.id),o.append("name",l.name),o.append("phone",l.phone);let r=!1;try{const N=await(await fetch("/PETRODIESEL2/public/workers/update_ajax",{method:"POST",body:o})).json();N.success?(m.success("تم تحديث بيانات العامل بنجاح"),r=!0):m.error(N.message||"حدث خطأ أثناء التحديث")}catch(u){console.error("Update Request Error:",u),m.error("فشل الاتصال بالخادم")}finally{f(!1)}if(r)try{c({...n,name:l.name,phone:l.phone}),t()}catch(u){console.error("Error updating UI state:",u)}};return e.jsx(O,{open:d,onClose:t,static:!0,className:"z-[100]",children:e.jsxs(D,{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl ring-1 ring-slate-900/5 p-0 overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 border-b border-slate-100 p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-navy-900"}),"تعديل بيانات العامل"]}),e.jsx("p",{className:"text-slate-500 text-sm",children:"تعديل اسم أو رقم العامل"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-500",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"الاسم"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:h,placeholder:"اسم العامل",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"رقم الهاتف"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"phone",value:l.phone,onChange:h,placeholder:"05xxxxxxxx",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all"})]})]}),e.jsxs("div",{className:"flex justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 rounded-lg transition-colors ml-2",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 text-sm font-bold text-white bg-navy-900 hover:bg-navy-800 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center gap-2",children:x?"جاري الحفظ...":e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4"}),"حفظ التغييرات"]})})]})]})]})})}const te=[{id:1,name:"Ali Ahmed",phone:"0501234567",national_id:"1020304050",status:"Active",station:"Main Station"},{id:2,name:"Khan Mohammed",phone:"0559876543",national_id:"2345678901",status:"Active",station:"Main Station"},{id:3,name:"Saeed Al-Ghamdi",phone:"0541122334",national_id:"1010101010",status:"On Leave",station:"North Branch"}];function ae({workers:d=[]}){const[t,n]=a.useState(Array.isArray(d)?d:[]);F.useEffect(()=>{n(Array.isArray(d)?d:[])},[d]);const[c,l]=a.useState(""),[p,x]=a.useState(!1),[f,h]=a.useState(!1),[j,i]=a.useState(null),o=s=>{i(s),h(!0)},r=s=>{n(y=>y.map(g=>g.id==s.id?{...g,...s}:g)),h(!1)},u=()=>{window.location.reload()},[N,v]=a.useState(!1),[b,w]=a.useState(null),[L,S]=a.useState(!1),P=s=>{w(s),v(!0)},W=async()=>{if(!b)return;S(!0);const s=new FormData;s.append("id",b.id);try{const g=await(await fetch("/PETRODIESEL2/public/workers/delete_ajax",{method:"POST",body:s})).json();g.success?(m.success("تم حذف العامل بنجاح"),n(R=>R.filter(T=>T.id!==b.id))):m.error(g.message||"فشل الحذف")}catch{m.error("خطأ في الاتصال")}finally{S(!1),v(!1),w(null)}},k=(t&&t.length>0?t:te).map(s=>({id:s.id,name:s.name,phone:s.phone||"N/A",national_id:s.national_id||s.iqama_id||"N/A",status:s.status?"Active":"On Leave",station:s.station_name||"Main Station"})).filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.phone.includes(c));return e.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsx(U,{isOpen:N,onClose:()=>v(!1),onConfirm:W,title:"تحذير: حذف عامل",message:`سيتم حذف العامل "${b==null?void 0:b.name}". هل أنت متأكد؟ لا يمكن التراجع عن هذا الإجراء.`,isDeleting:L}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-3xl font-bold text-navy-900 font-cairo",children:"إدارة العمال"}),e.jsx(H,{className:"text-slate-500",children:"سجل عمال المحطة والمناوبين"})]}),e.jsx(K,{icon:$,onClick:()=>x(!0),className:"rounded-xl font-bold bg-navy-900 hover:bg-navy-800 border-none",children:"إضافة عامل"})]}),e.jsx(E,{className:"rounded-2xl shadow-sm ring-1 ring-slate-200",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(G,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx(V,{placeholder:"بحث بالاسم أو رقم الجوال...",className:"pl-4 pr-10 py-2 rounded-xl",value:c,onChange:s=>l(s.target.value)})]})}),e.jsx(E,{className:"rounded-2xl shadow-lg ring-1 ring-slate-200 overflow-hidden p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"الاسم"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"رقم الجوال"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"الهوية الوطنية / الإقامة"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"الحالة"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"المحطة"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600 text-center",children:"إجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:k.map(s=>e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors group",children:[e.jsxs("td",{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-full text-slate-500",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx("span",{className:"font-bold text-navy-900",children:s.name})]}),e.jsx("td",{className:"p-4 font-mono text-slate-600",children:s.phone}),e.jsx("td",{className:"p-4 font-mono text-slate-600",children:s.national_id}),e.jsx("td",{className:"p-4",children:e.jsx(X,{size:"xs",color:s.status==="Active"?"emerald":"amber",children:s.status==="Active"?"على رأس العمل":"إجازة"})}),e.jsx("td",{className:"p-4 text-slate-500",children:s.station}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>o(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>P(s),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Q,{className:"w-4 h-4"})})]})})]},s.id))})]})})}),e.jsx(ee,{isOpen:p,onClose:()=>x(!1),onSuccess:u}),e.jsx(se,{isOpen:f,onClose:()=>h(!1),worker:j,onSuccess:r})]})}const re=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{Z as H,ae as W,re as a};
