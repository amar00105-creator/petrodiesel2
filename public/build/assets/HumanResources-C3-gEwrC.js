import{c as P,r as n,R as $,j as e,m as N,t as p,T as R,W as q,U as W,a as Y}from"./main-BZye3MWh.js";import{h as V,g as L,c as B,b as G,j as J,k as K,l as M}from"./Tracker-B3Wsk5ua.js";import{H as Q,W as X}from"./WorkerList-DlXq9GmB.js";import{D as z}from"./DeleteConfirmationModal-CGMvXUfk.js";import{S as _}from"./search-CFPY5UOd.js";import{P as A}from"./plus-CeiUBWS7.js";import{S as F}from"./square-pen-DTQcLPwn.js";import{T as U}from"./trash-2-D_DkLkqJ.js";import{S as Z}from"./shield-BA8HrkPo.js";import{S as ee}from"./save-C_qR2yBp.js";import{M as se}from"./minus-BNYzu2jm.js";import"./briefcase-B0PbUPAN.js";import"./x-CpP_tiue.js";import"./phone-s6QPuMec.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],ae=P("history",te);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ne=P("mail",le);function re({employees:a=[]}){const[c,t]=n.useState(Array.isArray(a)?a:[]);$.useEffect(()=>{t(Array.isArray(a)?a:[])},[a]);const[s,h]=n.useState(""),[d,x]=n.useState(!1),[r,m]=n.useState("add"),[u,j]=n.useState(null),g=c.filter(l=>{var f,y;return((f=l.name)==null?void 0:f.toLowerCase().includes(s.toLowerCase()))||((y=l.email)==null?void 0:y.toLowerCase().includes(s.toLowerCase()))}),k=()=>{m("add"),j(null),x(!0)},C=l=>{m("edit"),j(l),x(!0)},E=l=>{r==="add"?window.location.reload():(t(f=>f.map(y=>y.id==l.id?{...y,...l}:y)),x(!1))},[D,v]=n.useState(!1),[b,S]=n.useState(null),[o,w]=n.useState(!1),O=l=>{S(l),v(!0)},I=async()=>{if(!b)return;w(!0);const l=new FormData;l.append("id",b.id);try{const y=await(await fetch("/PETRODIESEL2/public/hr/api?entity=employee&action=delete",{method:"POST",body:l})).json();y.success?(p.success("تم الحذف بنجاح"),t(T=>T.filter(H=>H.id!==b.id))):p.error(y.message||"فشل الحذف")}catch{p.error("خطأ في الاتصال")}finally{w(!1),v(!1),S(null)}},i=l=>{switch(l){case"admin":return"rose";case"super_admin":return"purple";case"manager":return"blue";default:return"slate"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{isOpen:D,onClose:()=>v(!1),onConfirm:I,title:"تحذير: حذف موظف",message:`سيتم حذف الموظف "${b==null?void 0:b.name}" ولن يتمكن من الدخول للنظام. هل أنت متأكد؟`,isDeleting:o}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-navy-900",children:"الموظفين والإداريين"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"إدارة مستخدمي النظام وصلاحياتهم"})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(_,{className:"absolute right-3 top-2.5 text-slate-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"بحث بالاسم أو البريد...",className:"w-full pr-9 pl-4 py-2 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all",value:s,onChange:l=>h(l.target.value)})]}),e.jsx(V,{icon:A,onClick:k,className:"rounded-xl font-bold bg-navy-900 hover:bg-navy-800 border-none",children:"إضافة"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(l=>e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-4 border border-slate-100 shadow-sm hover:shadow-md transition-shadow group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-indigo-500"}),e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 flex items-center justify-center text-indigo-600 font-bold text-lg",children:l.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-navy-900",children:l.name}),e.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3"}),l.email]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>C(l),className:"p-1.5 hover:bg-slate-100 rounded-lg text-slate-600",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(l),className:"p-1.5 hover:bg-red-50 rounded-lg text-red-600",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-4 pt-4 border-t border-slate-50",children:[e.jsx(L,{size:"xs",color:i(l.role),icon:Z,children:l.role}),e.jsxs("span",{className:"text-xs text-slate-400",children:["ID: ",l.id]})]})]},l.id))}),d&&e.jsx(ie,{isOpen:d,onClose:()=>x(!1),mode:r,employee:u,onSuccess:E})]})}function ie({isOpen:a,onClose:c,mode:t,employee:s,onSuccess:h}){if(!a)return null;const d=async x=>{x.preventDefault();const r=new FormData(x.target);t==="edit"&&s&&r.append("id",s.id);let m=!1;try{const g=await(await fetch(`/PETRODIESEL2/public/hr/api?entity=employee&action=${t==="add"?"store":"update"}`,{method:"POST",body:r})).json();g.success?(p.success("تم الحفظ بنجاح"),m=!0):p.error(g.message||"حدث خطأ")}catch{p.error("خطأ في الاتصال")}m&&h({id:s==null?void 0:s.id,...s,name:r.get("name"),email:r.get("email"),role:r.get("role")})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 p-4 border-b border-slate-100 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg text-navy-900",children:t==="add"?"إضافة موظف جديد":"تعديل بيانات موظف"}),e.jsx("button",{onClick:c,className:"text-slate-400 hover:text-red-500 transition-colors",children:"×"})]}),e.jsxs("form",{onSubmit:d,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم"}),e.jsx("input",{type:"text",name:"name",required:!0,defaultValue:s==null?void 0:s.name,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),e.jsx("input",{type:"email",name:"email",defaultValue:s==null?void 0:s.email,placeholder:"اختياري (سيتم توليده تلقائياً)",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),e.jsx("input",{type:"password",name:"password",required:t==="add",placeholder:t==="edit"?"اتركها فارغة لعدم التغيير":"",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"الصلاحية"}),e.jsxs("select",{name:"role",defaultValue:(s==null?void 0:s.role)||"viewer",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-white",children:[e.jsx("option",{value:"viewer",children:"مشاهد (Viewer)"}),e.jsx("option",{value:"manager",children:"مدير (Manager)"}),e.jsx("option",{value:"admin",children:"مسؤول (Admin)"})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-2 text-sm font-bold",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-xl text-slate-600 hover:bg-slate-100 transition-colors",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200",children:"حفظ البيانات"})]})]})]})})}function oe({drivers:a=[]}){const[c,t]=n.useState(Array.isArray(a)?a:[]);$.useEffect(()=>{t(Array.isArray(a)?a:[])},[a]);const[s,h]=n.useState(""),[d,x]=n.useState(!1),[r,m]=n.useState("add"),[u,j]=n.useState(null),g=c.filter(i=>{var l,f,y;return((l=i.name)==null?void 0:l.toLowerCase().includes(s.toLowerCase()))||((f=i.phone)==null?void 0:f.includes(s))||((y=i.truck_number)==null?void 0:y.toLowerCase().includes(s.toLowerCase()))}),k=()=>{m("add"),j(null),x(!0)},C=i=>{m("edit"),j(i),x(!0)},E=i=>{r==="add"?window.location.reload():(t(l=>l.map(f=>f.id==i.id?{...f,...i}:f)),x(!1))},[D,v]=n.useState(!1),[b,S]=n.useState(null),[o,w]=n.useState(!1),O=i=>{S(i),v(!0)},I=async()=>{if(!b)return;w(!0);const i=new FormData;i.append("id",b.id);try{const f=await(await fetch("/PETRODIESEL2/public/hr/api?entity=driver&action=delete",{method:"POST",body:i})).json();f.success?(p.success("تم الحذف بنجاح"),t(y=>y.filter(T=>T.id!==b.id))):p.error(f.message||"فشل الحذف")}catch{p.error("خطأ في الاتصال")}finally{w(!1),v(!1),S(null)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{isOpen:D,onClose:()=>v(!1),onConfirm:I,title:"تحذير: حذف سائق",message:`سيتم حذف السائق "${b==null?void 0:b.name}". هل أنت متأكد؟ لا يمكن التراجع عن هذا الإجراء.`,isDeleting:o}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-navy-900",children:"سجل السائقين"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"إدارة السائقين وشاحناتهم"})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(_,{className:"absolute right-3 top-2.5 text-slate-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"بحث...",className:"w-full pr-9 pl-4 py-2 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:s,onChange:i=>h(i.target.value)})]}),e.jsx(V,{icon:A,onClick:k,className:"rounded-xl font-bold bg-navy-900 hover:bg-navy-800 border-none",children:"إضافة"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[g.map(i=>e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-4 border border-slate-100 shadow-sm hover:shadow-md transition-shadow group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-blue-500"}),e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 font-bold text-lg",children:i.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-navy-900",children:i.name}),e.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),i.truck_number||"بدون شاحنة"]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>C(i),className:"p-1.5 hover:bg-slate-100 rounded-lg text-slate-600",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(i),className:"p-1.5 hover:bg-red-50 rounded-lg text-red-600",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-4 pt-4 border-t border-slate-50",children:[e.jsx("div",{className:"text-slate-500",children:i.phone||"لا يوجد هاتف"}),e.jsx(L,{size:"xs",color:"slate",children:"سائق"})]})]},i.id)),g.length===0&&e.jsx("div",{className:"col-span-full text-center py-10 text-slate-400",children:"لا توجد نتائج"})]}),d&&e.jsx(de,{isOpen:d,onClose:()=>x(!1),mode:r,driver:u,onSuccess:E})]})}function de({isOpen:a,onClose:c,mode:t,driver:s,onSuccess:h}){if(!a)return null;const d=async x=>{x.preventDefault();const r=new FormData(x.target);t==="edit"&&s&&r.append("id",s.id);let m=!1;try{const g=await(await fetch(`/PETRODIESEL2/public/hr/api?entity=driver&action=${t==="add"?"store":"update"}`,{method:"POST",body:r})).json();g.success?(p.success(t==="add"?"تمت الإضافة بنجاح":"تم التحديث بنجاح"),m=!0):p.error(g.message||"حدث خطأ")}catch{p.error("خطأ في الاتصال")}m&&h({id:s==null?void 0:s.id,...s,name:r.get("name"),phone:r.get("phone"),truck_number:r.get("truck_number")})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 p-4 border-b border-slate-100 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg text-navy-900",children:t==="add"?"إضافة سائق جديد":"تعديل بيانات سائق"}),e.jsx("button",{onClick:c,className:"text-slate-400 hover:text-red-500 transition-colors",children:"×"})]}),e.jsxs("form",{onSubmit:d,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم"}),e.jsx("input",{type:"text",name:"name",required:!0,defaultValue:s==null?void 0:s.name,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"رقم الهاتف"}),e.jsx("input",{type:"text",name:"phone",defaultValue:s==null?void 0:s.phone,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"رقم الشاحنة / اللوحة"}),e.jsx("input",{type:"text",name:"truck_number",defaultValue:s==null?void 0:s.truck_number,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-2 text-sm font-bold",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-xl text-slate-600 hover:bg-slate-100 transition-colors",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200",children:"حفظ البيانات"})]})]})]})})}function ce({employees:a=[],workers:c=[],drivers:t=[]}){const[s,h]=n.useState("sheet"),[d,x]=n.useState(new Date().getMonth()+1),[r,m]=n.useState(new Date().getFullYear()),[u,j]=n.useState(""),[g,k]=n.useState(!1),[C,E]=n.useState("advance"),[D,v]=n.useState(null);n.useEffect(()=>{},[d,r]);const b=[...a.map(o=>({...o,type:"employee",typeName:"موظف"})),...c.map(o=>({...o,type:"worker",typeName:"عامل"})),...t.map(o=>({...o,type:"driver",typeName:"سائق"}))].filter(o=>o.name.toLowerCase().includes(u.toLowerCase())),S=(o,w)=>{v(o),E(w),k(!0)};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx(B,{className:"rounded-2xl shadow-sm ring-1 ring-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{children:"كشف الرواتب"}),e.jsxs(L,{children:[b.length," موظف"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full md:w-auto",children:[e.jsx("select",{value:d,onChange:o=>x(o.target.value),className:"bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm font-bold text-slate-700 outline-none",children:Array.from({length:12},(o,w)=>e.jsxs("option",{value:w+1,children:[w+1," - ",new Date(0,w).toLocaleString("ar-EG",{month:"long"})]},w+1))}),e.jsxs("select",{value:r,onChange:o=>m(o.target.value),className:"bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm font-bold text-slate-700 outline-none",children:[e.jsx("option",{value:"2024",children:"2024"}),e.jsx("option",{value:"2025",children:"2025"}),e.jsx("option",{value:"2026",children:"2026"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute right-3 top-2.5 text-slate-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"بحث...",className:"pl-4 pr-9 py-2 rounded-lg border border-slate-200 text-sm w-full md:w-48 outline-none focus:ring-2 focus:ring-blue-500",value:u,onChange:o=>j(o.target.value)})]})]})]})}),e.jsx("div",{className:"grid gap-4",children:b.map(o=>e.jsx(xe,{staff:o,onAction:S},`${o.type}-${o.id}`))}),e.jsx(ue,{isOpen:g,onClose:()=>k(!1),type:C,entity:D})]})}function xe({staff:a,onAction:c}){const[t,s]=n.useState(0),[h,d]=n.useState(!1),[x,r]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const g=await(await fetch(`/PETRODIESEL2/public/hr/api?entity=payroll&action=get_salary&e_type=${a.type}&e_id=${a.id}`)).json();g.success&&s(g.amount)}catch{}})()},[a]);const m=async()=>{r(!0);try{const u=new FormData;u.append("e_type",a.type),u.append("e_id",a.id),u.append("amount",t),await fetch("/PETRODIESEL2/public/hr/api?entity=payroll&action=set_salary",{method:"POST",body:u}),d(!1),p.success("تم حفظ الراتب الأساسي")}catch{p.error("خطأ في الحفظ")}finally{r(!1)}};return e.jsx(N.div,{layout:!0,className:"bg-white rounded-xl shadow-sm border border-slate-100 p-4 transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-1/4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-white
                        ${a.type==="employee"?"bg-indigo-500":a.type==="worker"?"bg-blue-500":"bg-emerald-500"}`,children:a.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800",children:a.name}),e.jsx(L,{size:"xs",color:"slate",children:a.typeName})]})]}),e.jsxs("div",{className:"flex-1 w-full grid grid-cols-2 md:grid-cols-4 gap-4 items-center",children:[e.jsxs("div",{className:"bg-slate-50 p-2 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"الراتب الأساسي"}),e.jsxs("div",{className:"flex items-center gap-2",children:[h?e.jsx("input",{type:"number",value:t,onChange:u=>s(u.target.value),className:"w-20 bg-white border border-slate-300 rounded px-1 text-sm"}):e.jsx("span",{className:"font-bold font-mono",children:Number(t).toLocaleString()}),h?e.jsx("button",{onClick:m,disabled:x,className:"text-green-600 hover:bg-green-100 p-1 rounded",children:e.jsx(ee,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>d(!0),className:"text-slate-400 hover:text-blue-600 p-1 rounded",children:e.jsx(ae,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"col-span-2 flex gap-2 justify-center",children:[e.jsxs("button",{onClick:()=>c(a,"advance"),className:"flex-1 py-2 px-3 bg-amber-50 text-amber-700 rounded-lg hover:bg-amber-100 font-bold text-sm flex justify-center items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"سلفة"})]}),e.jsxs("button",{onClick:()=>c(a,"deduction"),className:"flex-1 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 font-bold text-sm flex justify-center items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"خصم"})]}),e.jsxs("button",{onClick:()=>c(a,"bonus"),className:"flex-1 py-2 px-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 font-bold text-sm flex justify-center items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"مكافأة"})]})]}),e.jsxs("div",{className:"text-center bg-slate-800 text-white rounded-lg p-2",children:[e.jsx("div",{className:"text-[10px] text-slate-400",children:"الصافي التقديري"}),e.jsx("div",{className:"font-bold font-mono text-lg",children:Number(t).toLocaleString()})]})]})]})})}function ue({isOpen:a,onClose:c,type:t,entity:s}){if(!a||!s)return null;const h={advance:"تسجيل سلفة",deduction:"تسجيل خصم / جزاء",bonus:"تسجيل مكافأة"},d={advance:"amber",deduction:"red",bonus:"green"},x=async r=>{r.preventDefault();const m=new FormData(r.target);m.append("e_type",s.type),m.append("e_id",s.id),m.append("type",t);try{const j=await(await fetch("/PETRODIESEL2/public/hr/api?entity=payroll&action=add_entry",{method:"POST",body:m})).json();j.success?(p.success("تمت العملية بنجاح"),c()):p.error(j.message||"خطأ")}catch{p.error("خطأ في الاتصال")}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden",children:[e.jsxs("div",{className:`p-4 border-b border-${d[t]}-100 bg-${d[t]}-50 flex justify-between items-center`,children:[e.jsx("h3",{className:`font-bold text-lg text-${d[t]}-800`,children:h[t]}),e.jsx("button",{onClick:c,children:"×"})]}),e.jsxs("form",{onSubmit:x,className:"p-4 space-y-4",children:[e.jsx("div",{className:"text-center font-bold text-slate-700",children:s.name}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"المبلغ (ريال)"}),e.jsx("input",{type:"number",name:"amount",required:!0,step:"0.01",className:"w-full px-3 py-2 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none text-xl font-mono text-center"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"ملاحظات / السبب"}),e.jsx("textarea",{name:"notes",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"التاريخ"}),e.jsx("input",{type:"date",name:"date",required:!0,defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsx("button",{type:"submit",className:`w-full py-3 rounded-xl font-bold text-white shadow-lg bg-${d[t]==="amber"?"amber-500 hover:bg-amber-600":d[t]==="red"?"red-600 hover:bg-red-700":"green-600 hover:bg-green-700"}`,children:"حفظ"})]})]})})}function Ee(a){const{workers:c=[],employees:t=[],drivers:s=[]}=a,[h,d]=n.useState(0);return e.jsx("div",{className:"p-6 max-w-[1800px] mx-auto space-y-8 animate-fade-in",children:e.jsx("div",{className:"space-y-6",children:e.jsxs(J,{index:h,onIndexChange:d,children:[e.jsxs(K,{variant:"solid",className:"bg-white p-1 rounded-2xl shadow-sm border border-slate-100 max-w-3xl mx-auto",children:[e.jsx(M,{className:"px-6 py-2.5 rounded-xl font-bold text-slate-500 ui-selected:bg-indigo-600 ui-selected:text-white ui-selected:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),e.jsx("span",{children:"الموظفين"})]})}),e.jsx(M,{className:"px-6 py-2.5 rounded-xl font-bold text-slate-500 ui-selected:bg-blue-600 ui-selected:text-white ui-selected:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:"العمال"})]})}),e.jsx(M,{className:"px-6 py-2.5 rounded-xl font-bold text-slate-500 ui-selected:bg-emerald-600 ui-selected:text-white ui-selected:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"السائقين"})]})}),e.jsx(M,{className:"px-6 py-2.5 rounded-xl font-bold text-slate-500 ui-selected:bg-amber-500 ui-selected:text-white ui-selected:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{children:"الرواتب"})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(Y,{mode:"wait",children:[h===0&&e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},children:e.jsx(re,{employees:t})},"employees"),h===1&&e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},children:e.jsx(X,{workers:c})},"workers"),h===2&&e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},children:e.jsx(oe,{drivers:s})},"drivers"),h===3&&e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},children:e.jsx(ce,{employees:t,workers:c,drivers:s})},"payroll")]})})]})})})}export{Ee as default};
