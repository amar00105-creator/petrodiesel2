import{c as F,r as a,j as e,b as O,t as m,R as q,m as z}from"./main-BZye3MWh.js";import{n as D,d as M,b as U,m as B,h as H,c as E,p as K,g as $}from"./Tracker-B3Wsk5ua.js";import{B as A}from"./briefcase-B0PbUPAN.js";import{X as _}from"./x-CpP_tiue.js";import{P as C}from"./phone-s6QPuMec.js";import{S as I}from"./save-C_qR2yBp.js";import{D as G}from"./DeleteConfirmationModal-CGMvXUfk.js";import{P as V}from"./plus-CeiUBWS7.js";import{S as X}from"./search-CFPY5UOd.js";import{S as J}from"./square-pen-DTQcLPwn.js";import{T as Q}from"./trash-2-D_DkLkqJ.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],Z=F("hard-hat",Y);function ee({isOpen:d,onClose:t,onSuccess:n}){const[c,l]=a.useState({name:"",phone:""}),[u,x]=a.useState(!1),f=j=>{const{name:r,value:o}=j.target;l(i=>({...i,[r]:o}))},h=async j=>{j.preventDefault(),x(!0);const r=new FormData;r.append("name",c.name),r.append("phone",c.phone);try{const i=await(await fetch("/PETRODIESEL2/public/workers/create_ajax",{method:"POST",body:r})).json();i.success?(m.success("تم إضافة العامل بنجاح"),n(),t(),l({name:"",phone:""})):m.error(i.message||"حدث خطأ أثناء الإضافة")}catch{m.error("فشل الاتصال بالخادم")}finally{x(!1)}};return e.jsx(D,{open:d,onClose:t,static:!0,className:"z-[100]",children:e.jsxs(M,{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl ring-1 ring-slate-900/5 p-0 overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 border-b border-slate-100 p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-navy-900"}),"إضافة عامل جديد"]}),e.jsx("p",{className:"text-slate-500 text-sm",children:"أدخل بيانات العامل الجديد"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-500",children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"الاسم"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"name",value:c.name,onChange:f,placeholder:"اسم العامل",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"رقم الهاتف"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"phone",value:c.phone,onChange:f,placeholder:"05xxxxxxxx",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all"})]})]}),e.jsxs("div",{className:"flex justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 rounded-lg transition-colors ml-2",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:u,className:"px-6 py-2 text-sm font-bold text-white bg-navy-900 hover:bg-navy-800 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center gap-2",children:u?"جاري الحفظ...":e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4"}),"حفظ"]})})]})]})]})})}function se({isOpen:d,onClose:t,worker:n,onSuccess:c}){const[l,u]=a.useState({id:"",name:"",phone:""}),[x,f]=a.useState(!1);a.useEffect(()=>{n&&u({id:n.id||"",name:n.name||"",phone:n.phone||""})},[n]);const h=r=>{const{name:o,value:i}=r.target;u(p=>({...p,[o]:i}))},j=async r=>{r.preventDefault(),f(!0);const o=new FormData;o.append("id",l.id),o.append("name",l.name),o.append("phone",l.phone);let i=!1;try{const N=await(await fetch("/PETRODIESEL2/public/workers/update_ajax",{method:"POST",body:o})).json();N.success?(m.success("تم تحديث بيانات العامل بنجاح"),i=!0):m.error(N.message||"حدث خطأ أثناء التحديث")}catch(p){console.error("Update Request Error:",p),m.error("فشل الاتصال بالخادم")}finally{f(!1)}if(i)try{c({...n,name:l.name,phone:l.phone}),t()}catch(p){console.error("Error updating UI state:",p)}};return e.jsx(D,{open:d,onClose:t,static:!0,className:"z-[100]",children:e.jsxs(M,{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl ring-1 ring-slate-900/5 p-0 overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 border-b border-slate-100 p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-navy-900"}),"تعديل بيانات العامل"]}),e.jsx("p",{className:"text-slate-500 text-sm",children:"تعديل اسم أو رقم العامل"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-500",children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"الاسم"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:h,placeholder:"اسم العامل",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"رقم الهاتف"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:"text",name:"phone",value:l.phone,onChange:h,placeholder:"05xxxxxxxx",className:"w-full pr-10 pl-4 py-2 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-navy-500 transition-all"})]})]}),e.jsxs("div",{className:"flex justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 rounded-lg transition-colors ml-2",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 text-sm font-bold text-white bg-navy-900 hover:bg-navy-800 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center gap-2",children:x?"جاري الحفظ...":e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4"}),"حفظ التغييرات"]})})]})]})]})})}const te=[{id:1,name:"Ali Ahmed",phone:"0501234567",national_id:"1020304050",status:"Active",station:"Main Station"},{id:2,name:"Khan Mohammed",phone:"0559876543",national_id:"2345678901",status:"Active",station:"Main Station"},{id:3,name:"Saeed Al-Ghamdi",phone:"0541122334",national_id:"1010101010",status:"On Leave",station:"North Branch"}];function ae({workers:d=[]}){const[t,n]=a.useState(Array.isArray(d)?d:[]);q.useEffect(()=>{n(Array.isArray(d)?d:[])},[d]);const[c,l]=a.useState(""),[u,x]=a.useState(!1),[f,h]=a.useState(!1),[j,r]=a.useState(null),o=s=>{r(s),h(!0)},i=s=>{n(y=>y.map(g=>g.id==s.id?{...g,...s}:g)),h(!1)},p=()=>{window.location.reload()},[N,v]=a.useState(!1),[b,S]=a.useState(null),[L,w]=a.useState(!1),P=s=>{S(s),v(!0)},W=async()=>{if(!b)return;w(!0);const s=new FormData;s.append("id",b.id);try{const g=await(await fetch("/PETRODIESEL2/public/workers/delete_ajax",{method:"POST",body:s})).json();g.success?(m.success("تم حذف العامل بنجاح"),n(T=>T.filter(k=>k.id!==b.id))):m.error(g.message||"فشل الحذف")}catch{m.error("خطأ في الاتصال")}finally{w(!1),v(!1),S(null)}},R=(t&&t.length>0?t:te).map(s=>({id:s.id,name:s.name,phone:s.phone||"N/A",national_id:s.national_id||s.iqama_id||"N/A",status:s.status?"Active":"On Leave",station:s.station_name||"Main Station"})).filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.phone.includes(c));return e.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsx(G,{isOpen:N,onClose:()=>v(!1),onConfirm:W,title:"تحذير: حذف عامل",message:`سيتم حذف العامل "${b==null?void 0:b.name}". هل أنت متأكد؟ لا يمكن التراجع عن هذا الإجراء.`,isDeleting:L}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{className:"text-3xl font-bold text-navy-900 font-cairo",children:"إدارة العمال"}),e.jsx(B,{className:"text-slate-500",children:"سجل عمال المحطة والمناوبين"})]}),e.jsx(H,{icon:V,onClick:()=>x(!0),className:"rounded-xl font-bold bg-navy-900 hover:bg-navy-800 border-none",children:"إضافة عامل"})]}),e.jsx(E,{className:"rounded-2xl shadow-sm ring-1 ring-slate-200",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(X,{className:"absolute right-3 top-3 text-slate-400 w-5 h-5"}),e.jsx(K,{placeholder:"بحث بالاسم أو رقم الجوال...",className:"pl-4 pr-10 py-2 rounded-xl",value:c,onChange:s=>l(s.target.value)})]})}),e.jsx(E,{className:"rounded-2xl shadow-lg ring-1 ring-slate-200 overflow-hidden p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"الاسم"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"رقم الجوال"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"الهوية الوطنية / الإقامة"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"الحالة"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600",children:"المحطة"}),e.jsx("th",{className:"p-4 text-sm font-bold text-slate-600 text-center",children:"إجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:R.map(s=>e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors group",children:[e.jsxs("td",{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-full text-slate-500",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx("span",{className:"font-bold text-navy-900",children:s.name})]}),e.jsx("td",{className:"p-4 font-mono text-slate-600",children:s.phone}),e.jsx("td",{className:"p-4 font-mono text-slate-600",children:s.national_id}),e.jsx("td",{className:"p-4",children:e.jsx($,{size:"xs",color:s.status==="Active"?"emerald":"amber",children:s.status==="Active"?"على رأس العمل":"إجازة"})}),e.jsx("td",{className:"p-4 text-slate-500",children:s.station}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>o(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>P(s),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Q,{className:"w-4 h-4"})})]})})]},s.id))})]})})}),e.jsx(ee,{isOpen:u,onClose:()=>x(!1),onSuccess:p}),e.jsx(se,{isOpen:f,onClose:()=>h(!1),worker:j,onSuccess:i})]})}const fe=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{Z as H,ae as W,fe as a};
