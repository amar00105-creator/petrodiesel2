import{j as e,m as x,u as y,F as m,Z as k,R as h,c as S,S as D,o as E}from"./ui-Cx9d0ciQ.js";import{r as i}from"./vendor-BdFMDtQB.js";import{D as I,c as p,b,m as n,d as O,a as u,g as L}from"./main-CZ5QbTZK.js";function R({pumps:d=[],tanks:P=[],workers:_=[]}){const[g,r]=i.useState(!1),[a,o]=i.useState(null),f=s=>{o(s),r(!0)},[j,c]=i.useState(!1),N=async()=>{if(!a)return;c(!0);const s=new FormData;s.append("id",a.id);try{const l=await(await fetch("/PETRODIESEL2/public/pumps/delete_ajax",{method:"POST",body:s})).json();l.success?window.location.reload():alert(l.message||"فشل عملية الحذف")}catch(t){console.error(t),alert("خطأ في الاتصال")}finally{c(!1),r(!1),o(null)}},w={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},v={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs(x.div,{initial:"hidden",animate:"visible",variants:w,className:"p-6 max-w-7xl mx-auto",children:[e.jsx(I,{isOpen:g,onClose:()=>r(!1),onConfirm:N,title:"تحذير: حذف ماكينة وقود",isDeleting:j,message:`سيتم حذف الماكينة "${a==null?void 0:a.name}" وجميع عداداتها المرتبطة. هل أنت متأكد؟`}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("a",{href:"/PETRODIESEL2/public/pumps/create",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-blue-500/30 transition-all flex items-center gap-2 font-bold",children:[e.jsx(y,{className:"w-5 h-5"})," إضافة ماكينة"]})}),d.length===0?e.jsxs(p,{className:"text-center py-20 bg-slate-50 border-dashed border-2 border-slate-200",children:[e.jsx("div",{className:"inline-flex p-4 bg-slate-100 rounded-full mb-4 text-slate-400",children:e.jsx(m,{className:"w-12 h-12"})}),e.jsx(b,{className:"text-slate-600",children:"لا توجد مكائن مضافة"}),e.jsx(n,{className:"mt-2 text-slate-400",children:"ابدأ بإضافة أول ماكينة وقود للنظام"})]}):e.jsx(O,{numItems:2,numItemsMd:3,numItemsLg:4,className:"gap-3 md:gap-6",children:d.map(s=>e.jsx(x.div,{variants:v,children:e.jsxs(p,{className:"h-full flex flex-col hover:shadow-xl transition-shadow border-t-4 border-t-blue-500 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:e.jsx(m,{className:"w-24 h-24"})}),e.jsxs(u,{className:"mb-4 items-start",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-[10px] md:text-xs font-bold text-blue-500 uppercase tracking-wider mb-1 truncate",children:s.tank_name||"خزان غير محدد"}),e.jsx(b,{className:"text-lg md:text-2xl font-black text-slate-800 break-words leading-tight",children:s.name})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(L,{icon:k,color:"emerald",size:"xs",className:"scale-75 origin-right md:scale-100 shadow-emerald-500/20 shadow-lg",children:"نشط"}),e.jsx("span",{className:"text-[8px] md:text-[10px] font-bold text-slate-400 uppercase tracking-widest px-1.5 py-0.5 bg-slate-100 rounded-full",children:s.product_type||"وقود"})]})]}),e.jsxs("div",{className:"bg-slate-50/50 rounded-xl p-2 md:p-4 mb-2 md:mb-4 flex-grow space-y-2 md:space-y-3 border border-slate-100",children:[e.jsxs(n,{className:"text-[9px] md:text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1 md:mb-2 flex items-center gap-2",children:[e.jsx(h,{className:"w-3 h-3"})," العدادات"]}),s.counters&&s.counters.length>0?s.counters.map((t,l)=>e.jsxs("div",{className:"group/counter relative flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-2 md:p-3 rounded-lg shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 w-full",children:[e.jsx("div",{className:"hidden md:block p-2.5 bg-blue-50 text-blue-600 rounded-lg",children:e.jsx(h,{className:"w-5 h-5"})}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"font-mono text-sm md:text-lg font-black text-slate-700 leading-none mb-1 text-right dir-ltr truncate",children:parseFloat(t.current_reading).toLocaleString("en-US",{minimumFractionDigits:2})}),t.worker_name?e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-500 font-bold bg-slate-100 px-2 py-0.5 rounded-md w-fit mt-1",children:[e.jsx(S,{className:"w-3 h-3 text-slate-400"}),e.jsx("span",{className:"pt-0.5",children:t.worker_name})]}):e.jsx("div",{className:"text-[10px] text-slate-400 italic mt-1",children:"غير مخصص"})]})]}),e.jsx("div",{className:"absolute top-2 left-2 text-[10px] font-black text-slate-200 group-hover/counter:text-blue-100 transition-colors max-w-[50%] truncate",children:t.name||`#${String(l+1).padStart(2,"0")}`})]},t.id)):e.jsx("div",{className:"text-center py-4 text-slate-400 text-sm italic",children:"لا توجد عدادات مرتبطة"})]}),e.jsxs(u,{className:"mt-auto pt-4 border-t border-slate-100 gap-2",children:[e.jsxs("a",{href:`/PETRODIESEL2/public/pumps/edit?id=${s.id}`,className:"flex-1 py-2 px-3 rounded-lg bg-slate-50 hover:bg-blue-50 text-slate-600 hover:text-blue-600 font-medium text-sm transition-colors flex items-center justify-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"})," تعديل"]}),e.jsx("button",{onClick:()=>f(s),className:"py-2 px-3 rounded-lg bg-slate-50 hover:bg-red-50 text-slate-600 hover:text-red-500 transition-colors",children:e.jsx(E,{className:"w-4 h-4"})})]})]})},s.id))})]})}export{R as default};
